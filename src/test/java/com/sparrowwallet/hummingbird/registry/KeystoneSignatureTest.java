package com.sparrowwallet.hummingbird.registry;

import java.util.ArrayList;
import java.util.UUID;
import java.nio.ByteBuffer;
import co.nstant.in.cbor.CborDecoder;
import co.nstant.in.cbor.CborException;
import co.nstant.in.cbor.model.DataItem;
import com.sparrowwallet.hummingbird.TestUtils;
import org.junit.Assert;
import org.junit.Test;

import java.util.Arrays;
import java.util.List;

public class KeystoneSignatureTest {
    @Test
    public void testKeysthoneSignature() throws CborException {
        String signature = "1f8b08000000000000005d923d8a16400c86112d5611842dad2c2c6c3ec8ff64ac64bd8057986492467071b5f150dec04a3c920770167f0adf72e07d923cccd583eb67efebcba7cfb71feac5c7bbbcddf5fcdba3abc7d757480a3776f3f6f5d7474f5e8a2e54cc7591c0bc48cab8c4cebc28aed9386158d7f51becc2893cab79270385b96443ef00a87206444ec6083a94464f09b6d126a4cb17daf3ef0f81e07770f1791448b733622c08d81031c7acbd065ba241e446b488d496d5549a5466a2dc8d03f037c8960c061120022c77729c539a736bdb5492b690013b1459d8e4f44f8112bb69570c011f14f3f077df33c6589d40bdcdf646986b2cd53567ce6193ad6ab3910b9197b5ab158fee755a895e3b8e0442a01a6b21d1dadb9b54c0623b6b16b54777a8a4bbce004bc8c5515ad3d7b43e56936d4bff0990c3b4e9f02f78f6581365341ed3762ccdc1674aea9ce35ce296465a58ab5866b0fb4a76756fb0ff198cc34b6124b1cb32dee1c377298796988a771dbba5f78cbfdd573f7e3ea0a7fffed4bbbbdb5f9d04fec864020000";
        byte[] signData = TestUtils.hexToBytes(signature);       
        KeystoneSignature keystoneSignature = new KeystoneSignature(signData);
        String hexString = TestUtils.encode(keystoneSignature.toCbor());
        Assert.assertEquals("a1015901911f8b08000000000000005d923d8a16400c86112d5611842dad2c2c6c3ec8ff64ac64bd8057986492467071b5f150dec04a3c920770167f0adf72e07d923cccd583eb67efebcba7cfb71feac5c7bbbcddf5fcdba3abc7d757480a3776f3f6f5d7474f5e8a2e54cc7591c0bc48cab8c4cebc28aed9386158d7f51becc2893cab79270385b96443ef00a87206444ec6083a94464f09b6d126a4cb17daf3ef0f81e07770f1791448b733622c08d81031c7acbd065ba241e446b488d496d5549a5466a2dc8d03f037c8960c061120022c77729c539a736bdb5492b690013b1459d8e4f44f8112bb69570c011f14f3f077df33c6589d40bdcdf646986b2cd53567ce6193ad6ab3910b9197b5ab158fee755a895e3b8e0442a01a6b21d1dadb9b54c0623b6b16b54777a8a4bbce004bc8c5515ad3d7b43e56936d4bff0990c3b4e9f02f78f6581365341ed3762ccdc1674aea9ce35ce296465a58ab5866b0fb4a76756fb0ff198cc34b6124b1cb32dee1c377298796988a771dbba5f78cbfdd573f7e3ea0a7fffed4bbbbdb5f9d04fec864020000", hexString);
    }
}